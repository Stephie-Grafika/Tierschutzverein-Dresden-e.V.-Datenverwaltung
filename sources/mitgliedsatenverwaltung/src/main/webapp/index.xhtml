<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>TSV Mitgliedsverwaltung</title>
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" media="screen" href="color.css"/>
	<link rel="stylesheet" type="text/css" media="screen" href="fonts.css"/>
	<link rel="stylesheet" type="text/css" media="screen" href="styles.css"/>
	<link rel="shortcut icon" type="image/x-icon" href="/assets/favicon/Tierschutzverein-Dresden-Favicon.png"/>
	<!-- Indexierung verhindern -->
	<meta name="robots" content="noindex"/>
</h:head>
<h:body>
	<!-- Header & Logo -->
	<header>
		<img src="assets/img/TSV-Logo.png" id="logo"/>
		<br/><br/><h1>TSV: Mitgliedsverwaltung</h1>
		<br/><hr/><br/><br/>
	</header>
    <h:form id="form">
        <p:growl id="messages" showDetail="true" />

        <p:toolbar>
            <p:toolbarGroup>
                <p:commandButton value="New" icon="pi pi-plus" actionListener="#{crudView.openNew}"
                    update=":dialogs:manage-product-content" oncomplete="PF('manageProductDialog').show()"
                    styleClass="ui-button-success" style="margin-right: .5rem">
                    <p:resetInput target=":dialogs:manage-product-content" />
                </p:commandButton>
                <p:commandButton id="delete-products-button" value="#{crudView.deleteButtonMessage}"
                    icon="pi pi-trash" actionListener="#{crudView.deleteSelectedProducts}"
                    styleClass="ui-button-danger" disabled="#{!crudView.hasSelectedProducts()}" update="@this">
                    <p:confirm header="Confirmation" message="Delete the selected products?"
                        icon="pi pi-exclamation-triangle" />
                </p:commandButton>
            </p:toolbarGroup>
            <p:toolbarGroup align="right">
                <p:fileUpload mode="simple" skinSimple="true" label="Import" chooseIcon="pi pi-download" />
                <p:commandButton value="Export" icon="pi pi-upload" styleClass="ui-button-help" ajax="false">
                    <p:dataExporter type="pdf" target="dt-products" fileName="products" />
                </p:commandButton>
            </p:toolbarGroup>
        </p:toolbar>

        <p:dataTable id="dt-products" widgetVar="dtProducts" var="product" value="#{crudView.products}"
            reflow="true" styleClass="products-table" selectionMode="multiple" selection="#{crudView.selectedProducts}"
            rowKey="#{product.code}" paginator="true" rows="10" selectionRowMode="add" paginatorPosition="bottom">
            <f:facet name="header">
                <div class="products-table-header">
                    <span style="font-weight: bold">PRODUCTS</span>
                    <span class="filter-container ui-input-icon-left"> <i class="pi pi-search"></i>
                        <p:inputText id="globalFilter" onkeyup="PrimeFaces.debounce(() => PF('dtProducts').filter())" placeholder="Search" />
                    </span>
                </div>
            </f:facet>

            <p:ajax event="rowSelect" update=":form:delete-products-button" />
            <p:ajax event="rowUnselect" update=":form:delete-products-button" />
            <p:ajax event="rowSelectCheckbox" update=":form:delete-products-button" />
            <p:ajax event="rowUnselectCheckbox" update=":form:delete-products-button" />
            <p:ajax event="toggleSelect" update=":form:delete-products-button" />

            <p:column selectionBox="true" exportable="false"></p:column>

            <p:column headerText="Code" sortBy="#{product.code}" filterBy="#{product.code}">
                <h:outputText value="#{product.code}" />
            </p:column>
            <p:column headerText="Name" sortBy="#{product.name}" filterBy="#{product.name}">
                <h:outputText value="#{product.name}" />
            </p:column>
            <p:column headerText="Image" exportable="false">
                <p:graphicImage name="images/product/#{product.image}" library="demo" styleClass="product-image" />
            </p:column>
            <p:column headerText="Price" sortBy="#{product.price}">
                <h:outputText value="#{product.price}" style="font-weight: 700">
                    <f:convertNumber currencySymbol="$" type="currency" />
                </h:outputText>
            </p:column>
            <p:column headerText="Category" sortBy="#{product.category}" filterBy="#{product.category}">
                <h:outputText value="#{product.category}" />
            </p:column>
            <p:column headerText="Reviews" sortBy="#{product.rating}">
                <p:rating value="#{product.rating}" readonly="true" />
            </p:column>
            <p:column headerText="Status" sortBy="#{product.inventoryStatus}"
                filterBy="#{product.inventoryStatus}">
                <h:outputText styleClass="product-badge status-#{product.inventoryStatus.name().toLowerCase()}"
                    value="#{product.inventoryStatus.text}" />
            </p:column>
            <p:column exportable="false" ariaHeaderText="Actions">
                <p:commandButton icon="pi pi-pencil" update=":dialogs:manage-product-content"
                    oncomplete="PF('manageProductDialog').show()"
                    styleClass="edit-button rounded-button ui-button-success" process="@this">
                    <f:setPropertyActionListener value="#{product}" target="#{crudView.selectedProduct}" />
                    <p:resetInput target=":dialogs:manage-product-content" />
                </p:commandButton>
                <p:commandButton class="ui-button-warning rounded-button" icon="pi pi-trash"
                                 process="@this"
                                 oncomplete="PF('deleteProductDialog').show()">
                    <f:setPropertyActionListener value="#{product}" target="#{crudView.selectedProduct}" />
                </p:commandButton>
            </p:column>

        </p:dataTable>
    </h:form>

    <h:form id="dialogs">
        <p:dialog header="Product Details" showEffect="fade" modal="true" widgetVar="manageProductDialog"
            responsive="true">
            <p:outputPanel id="manage-product-content" class="ui-fluid">
                <p:outputPanel rendered="#{not empty crudView.selectedProduct}">
                    <p:graphicImage name="images/product/#{crudView.selectedProduct.image}" library="demo"
                        styleClass="product-image" rendered="#{not empty crudView.selectedProduct.image}" />
                    <div class="field">
                        <p:outputLabel for="name">Name</p:outputLabel>
                        <p:inputText id="name" value="#{crudView.selectedProduct.name}" required="true" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="description">Description</p:outputLabel>
                        <p:inputTextarea id="description" value="#{crudView.selectedProduct.description}" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="category">Category</p:outputLabel>
                        <p:selectOneRadio id="category" value="#{crudView.selectedProduct.category}"
                            layout="responsive" columns="2">
                            <f:selectItem itemLabel="Accessories" itemValue="Accessories" />
                            <f:selectItem itemLabel="Clothing" itemValue="Clothing" />
                            <f:selectItem itemLabel="Electronics" itemValue="Electronics" />
                            <f:selectItem itemLabel="Fitness" itemValue="Fitness" />
                        </p:selectOneRadio>
                    </div>
                    <div class="formgrid grid">
                        <div class="field col">
                            <p:outputLabel for="price">Price</p:outputLabel>
                            <p:inputNumber id="price" value="#{crudView.selectedProduct.price}" symbol=" USD"
                                symbolPosition="s" decimalSeparator="." thousandSeparator="," />
                        </div>
                        <div class="field col">
                            <p:outputLabel for="quantity">Quantity</p:outputLabel>
                            <p:spinner id="quantity" min="0" value="#{crudView.selectedProduct.quantity}" />
                        </div>
                    </div>
                </p:outputPanel>
            </p:outputPanel>

            <f:facet name="footer">
                <p:commandButton value="Save" icon="pi pi-check" actionListener="#{crudView.saveProduct}"
                    update="manage-product-content" process="manage-product-content @this" />
                <p:commandButton value="Cancel" icon="pi pi-times" onclick="PF('manageProductDialog').hide()"
                    class="ui-button-secondary" type="button" />
            </f:facet>
        </p:dialog>

        <p:confirmDialog widgetVar="deleteProductDialog" showEffect="fade" width="300"
            message="Delete the product?" header="Confirm" severity="warn">
            <p:commandButton value="Yes" icon="pi pi-check" actionListener="#{crudView.deleteProduct}"
                process="@this" update=":form:delete-products-button"
                oncomplete="PF('deleteProductDialog').hide()" />
            <p:commandButton value="No" type="button" styleClass="ui-button-secondary" icon="pi pi-times"
                onclick="PF('deleteProductDialog').hide()" />
        </p:confirmDialog>

        <p:confirmDialog global="true" showEffect="fade" width="300">
            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-secondary"
                icon="pi pi-times" />
        </p:confirmDialog>
    </h:form>
</div>
	<h:form>
		<p:dataTable id="table" var="emission" value="#{emissionTabelle.liste}" emptyMessage="Kein Land unter dieser Suche gefunden." size="small" stickyHeader="true" stickyTopAt=".layout-topbar">
			<p:column headerText="ID" sortBy="#{emission.ID}">
				<p:outputLabel value="#{emission.ID}" id="IDInput"></p:outputLabel>
			</p:column>
			<p:column headerText="Land" sortBy="#{emission.land}" filterBy="#{emission.land}" filterPlaceholder="Suchen">
				<p:inputText value="#{emission.land}" id="landInput" required="true" requiredMessage="Landname ist erforderlich">
					<f:validateRegex pattern="[a-zA-ZäöüÄÖÜß(),.;:'-–&amp; ]+"/>
				</p:inputText>
			</p:column>
			<p:column headerText="Landcode" sortBy="#{emission.landCode}">
				<p:inputText value="#{emission.landCode}" id="landCode" label="Landcode" validatorMessage="Landcode darf nur aus 3 Buchstaben bestehen">
					<f:validateRegex pattern="[a-zA-ZäöüÄÖÜß ]+"/>
					<f:validateLength minimum="3" maximum="3"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 1990" sortBy="#{emission.emission1990}">
				<p:inputText value="#{emission.emission1990}" id="emission1990Input" label="Emission 1990" validatorMessage="Emmission 1990 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 2000" sortBy="#{emission.emission2000}">
				<p:inputText value="#{emission.emission2000}" id="emission2000Input" label="Emission 2000" validatorMessage="Emmission 2000 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 2010" sortBy="#{emission.emission2010}">
				<p:inputText value="#{emission.emission2010}" id="emission2010Input" label="Emission 2010" validatorMessage="Emmission 2010 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 2020" sortBy="#{emission.emission2020}">
				<p:inputText value="#{emission.emission2020}" id="emission2020Input" label="Emission 2020" validatorMessage="Emmission 2020 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 2030" sortBy="#{emission.emission2030}">
				<p:inputText value="#{emission.emission2030}" id="emission2030Input" label="Emission 2030" validatorMessage="Emmission 2030 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="CO2-Emissions (kt) 2040" sortBy="#{emission.emission2040}">
				<p:inputText value="#{emission.emission2040}" id="emission2040Input" label="Emission 2040" validatorMessage="Emmission 2040 darf nicht negativ sein">
					<f:validateDoubleRange minimum="0.00"/>
				</p:inputText>
			</p:column>
			<p:column headerText="">
           		<p:commandLink value="&#10008; Löschen" action="#{emissionTabelleController.deleteEmission(emission)}" update="table" />
        	</p:column>
		</p:dataTable>
		<div class="positionierter-button">
			<p:messages id="messages">
				<p:autoUpdate />
			</p:messages>
			<p:commandButton value="speichern" icon="pi pi-check" action="#{emissionTabelleController.stopEdit}" />
			<p:commandButton value="Neues Land hinzufügen" icon="pi pi-plus" action="#{emissionTabelleController.addEmission}" update="table" />
		</div>
	</h:form>
	<footer>
	<br/><br/><hr/><br/>
		<ul>
          	<li>© Stephanie Ott (4237273) 2025</li>
		</ul>
	</footer>
</h:body>
</html>